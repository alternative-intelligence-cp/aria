// Test macro variable scoping bug

%macro GEN_TEST 2
    func:test_%1 = int32(%1:x) {
        int32:count = 0;
        %1:val = x;
        int32:i = 0;
        
        while (i < %2) {
            if ((val & 1) != 0) {
                count = count + 1;
            }
            val = val >> 1;
            i = i + 1;
        }
        
        pass(count);
    };
%endmacro

// Expand twice
GEN_TEST(int8, 8)
GEN_TEST(int16, 16)

func:main = int32() {
    pass(0);
};
