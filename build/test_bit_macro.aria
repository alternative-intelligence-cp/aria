%macro GEN_BIT_UTILS 2
func:popcount_%1 = *int32(%1:x) {
    int32:count = 0;
    %1:val = x;
    int32:i = 0;
    
    while (i < %2) {
        if ((val & 1) != 0) {
            count = count + 1;
        }
        val = val >> 1;
        i = i + 1;
    }
    
    return count;
};
%endmacro

GEN_BIT_UTILS(int8, 8)
